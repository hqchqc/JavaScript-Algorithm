<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        function DoublyLinkedList(){
            // å±æ€§
            this.length = 0
            this.head = null
            this.tail = null
            // å†…éƒ¨ç±»
            function Node(data){
                this.data = data
                this.prev = null
                this.next = null
            }
            // 1.appendæ–¹æ³•
            DoublyLinkedList.prototype.append = function(data){
                var node = new Node(data)
                // åˆ¤æ–­æ˜¯å¦ä¸ºç¬¬ä¸€ä¸ªèŠ‚ç‚¹
                if(this.length == 0){
                    this.head = node
                    this.tail = node
                }else{
                    node.prev = this.tail
                    this.tail.next = node
                    this.tail = node
                }
                // ä¸è¦å¿˜è®°é•¿åº¦åŠ ä¸€
                this.length++
            }

            // 2.toStringæ–¹æ³•
            DoublyLinkedList.prototype.toString = function(){
                return this.forwardString()
            }
            // 2.1 forwardStringæ–¹æ³•
            DoublyLinkedList.prototype.forwardString = function(){
                var result = ''
                var current = this.head
                while(current){
                    result += current.data + ' '
                    current = current.next
                }
                return result
            }
            // 2.2 backwardStringæ–¹æ³•
            DoublyLinkedList.prototype.backwardString = function(){
                var result = ''
                var current = this.tail
                while(current){
                    result += current.data + ' '
                    current = current.prev
                }
                return result
            }

            // 3.insertæ–¹æ³• å…ˆå¤„ç†nodeçš„å‰ä¸€ä¸ªå’Œåä¸€ä¸ª å†å¤„ç†æ’å…¥ä½ç½®çš„å‰ä¸€ä¸ªå’Œåä¸€ä¸ª
            DoublyLinkedList.prototype.insert = function(data,position){
                // è¶Šç•Œå¤„ç†
                if(position < 0 || position > this.length){
                    return false
                }else{
                    // å› ä¸ºæ­¤æ—¶å¤šäº†ä¸€ä¸ªtailæŒ‡é’ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»åˆ¤æ–­æ’å…¥æ—¶æ˜¯å¦æœ‰å…¶ä»–å…ƒç´ 
                    var node = new Node(data)
                    // 1. æ’å…¥æ—¶æ²¡æœ‰ä»»ä½•å…ƒç´ 
                    if(this.length == 0){
                        this.head = node
                        this.tail = node
                    }else{
                        // 2. æ’å…¥æ—¶æœ‰å…ƒç´ 
                        if(position == 0){
                            // 2.1 æ’å…¥æ—¶æœ‰å…ƒç´  æ’å…¥ä½ç½®ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ æ—¶
                            node.next = this.head
                            this.head.prev = node
                            this.head = node
                        }else if(position == this.length){
                            // 2.2 æ’å…¥æ—¶æœ‰å…ƒç´ ,æ’å…¥ä½ç½®ä¸ºæœ€åä¸€ä¸ªå…ƒç´ æ—¶
                            node.prev = this.tail
                            this.tail.next = node
                            this.tail = node
                        }else{
                            // 2.3 æ’å…¥æ—¶æœ‰å…ƒç´ ï¼Œæ’å…¥ä½ç½®ä¸ºå…¶å®ƒæ—¶
                            var current = this.head
                            for(var i=0; i<position; i++){
                                current = current.next
                            }
                            node.prev = current.prev
                            node.next = current
                            current.prev.next = node
                            current.prev = node
                        }
                    }
                    this.length++
                    return true
                }  
            }

            // 4.getæ–¹æ³•
            DoublyLinkedList.prototype.get = function(position){
                // è¶Šç•Œå¤„ç†
                if(position < 0 || position >= this.length){
                    return false
                }else{
                    // å¦‚æœæ­£å‘æ‰¾é‚£ä¹ˆæ•ˆç‡ä¸æ˜¯å¾ˆé«˜
                    // åˆ¤æ–­ position ä¸é•¿åº¦
                    if(position <= this.length/2){
                        // æ­£å‘éå†
                        var current = this.head
                        for(var i=0; i<position; i++){
                            current = current.next
                        }
                        return current.data
                    }else{
                        // åå‘éå†
                        var current = this.tail
                        for(var i=this.length-1; i>position; i--){
                            current = current.prev
                        }
                        return current.data
                    }  
                }
            }

            // 5.indexOfæ–¹æ³•
            DoublyLinkedList.prototype.indexOf = function(data){
                var current = this.head
                for(var i=0; i<this.length; i++){
                    if(current.data == data){
                        return i
                    }
                    current = current.next
                }
                return -1
            }

            // 6.updateæ–¹æ³•
            DoublyLinkedList.prototype.update = function(data,position){
                // è¶Šç•Œå¤„ç†
                if(position < 0 || position >= this.length){
                    return false
                }else{
                    // è¿™é‡Œç”±äºæ²¡æœ‰ä¿®æ”¹æŒ‡é’ˆ åªéœ€ä¿®æ”¹å€¼å³å¯ æ‰€ä»¥ä¸ç”¨åŒºåˆ†æƒ…å†µ
                    var node = new Node(data)
                    var current = this.head
                    // ä¸¤ç§æ–¹å¼éå†
                    if(position <= this.length/2){
                        // æ­£å‘éå†
                        var current = this.head
                        for(var i=0; i<position; i++){
                            current = current.next
                        }
                        current.data = node.data 

                    }else{
                        // åå‘éå†
                        var current = this.tail
                        for(var i=this.length-1; i>position; i--){
                            current = current.prev
                        }
                        current.data = node.data 
                    }                          
                    return true
                }
            }

            // 7.removeAtæ–¹æ³•
            DoublyLinkedList.prototype.removeAt = function(position){
                // è¶Šç•Œ
                if(position<0 || position>=this.length){
                    return false
                }else{
                    var current = this.head
                    // ç§»é™¤æ‰è‚¯å®šè¦ä¿®æ”¹æŒ‡é’ˆ æ‰€ä»¥è¦åˆ†æƒ…å†µ    
                    if(this.length == 1){
                        // å¦‚æœé‡Œé¢å°±åªæœ‰ä¸€ä¸ªå…ƒç´ 
                        this.head = null
                        this.tail = null
                    }else{
                        // é‡Œé¢æœ‰å¾ˆå¤šå…ƒç´ çš„æƒ…å†µ
                        if(position == 0){
                            // åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ 
                            this.head.next.prev = null
                            this.head = this.head.next
                        }else if(position == this.length-1){
                            // åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ 
                            this.tail.prev.next = null
                            this.tail = this.tail.prev
                            current = this.tail 
                        }else{          
                            // åˆ é™¤ä¸­é—´å…ƒç´           
                            for(var i=0; i<position; i++){
                                current = current.next
                            }
                            current.prev.next = current.next
                            current.next.prev = current.prev 
                        }
                    }   
                    this.length--
                    return current.data                   
                }
            }

            // 8.removeæ–¹æ³•
            DoublyLinkedList.prototype.remove = function(data){
                // 1.å…ˆæ‰¾åˆ°æ­¤å…ƒç´ çš„ä¸‹æ ‡å€¼
                var removeDate = this.indexOf(data)
                // 2.é€šè¿‡ä¸‹æ ‡æ¥åˆ é™¤æ­¤å…ƒç´ 
                this.removeAt(removeDate)
            }

            // 9.sizeæ–¹æ³•
            DoublyLinkedList.prototype.size = function(){
                return this.length
            }

            // 10.isEmptyæ–¹æ³•
            DoublyLinkedList.prototype.isEmpty = function () {  
                return this.length == 0
            }

            // 11.è·å–é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
            DoublyLinkedList.prototype.getHead = function(){
                return this.head.data
            }

            // 12.è·å–é“¾è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ 
            DoublyLinkedList.prototype.getTail = function () {  
                return this.tail.data
            }
            
        }

        // æµ‹è¯•ä»£ç 
        var doublyLinkedList = new DoublyLinkedList
        // 1. appendæ–¹æ³•
        doublyLinkedList.append('ğŸ¦Š')
        doublyLinkedList.append('ğŸ•')
        doublyLinkedList.append('ğŸ±')
        // alert(doublyLinkedList)
        // // 2. toStringæ–¹æ³•
        // alert(doublyLinkedList.forwardString())
        // // 3. backwardStringæ–¹æ³•
        // alert(doublyLinkedList.backwardString())
        // 3. insertæ–¹æ³•
        doublyLinkedList.insert('ğŸ…',0)
        alert(doublyLinkedList)
        doublyLinkedList.insert('ğŸ¦',4)
        alert(doublyLinkedList)
        // 4. getæ–¹æ³•
        alert(doublyLinkedList.get(0))
        alert(doublyLinkedList.get(4))
        // 5. indexOfæ–¹æ³•
        alert(doublyLinkedList.indexOf('ğŸ¦'))
        alert(doublyLinkedList.indexOf('ğŸ…'))
        alert(doublyLinkedList.indexOf('ğŸ'))
        // 6.updateæ–¹æ³•
        doublyLinkedList.update('ğŸ€',0)
        alert(doublyLinkedList)
        doublyLinkedList.update('ğŸ',4)
        alert(doublyLinkedList)
        // 7.removeAtæ–¹æ³•
        doublyLinkedList.removeAt(0)
        alert(doublyLinkedList)
        doublyLinkedList.removeAt(1)
        alert(doublyLinkedList)
        doublyLinkedList.removeAt(2)
        alert(doublyLinkedList)
        // 8.removeæ–¹æ³•
        doublyLinkedList.remove('ğŸ¦Š')
        alert(doublyLinkedList)
        // 9.isEmptyæ–¹æ³•
        alert(doublyLinkedList.isEmpty())
        // 10.sizeæ–¹æ³•
        alert(doublyLinkedList.size())
        // 11.getHeadæ–¹æ³•
        alert(doublyLinkedList.getHead())
        // 12.getTailæ–¹æ³•
        alert(doublyLinkedList.getTail())
    </script>
</body>
</html>